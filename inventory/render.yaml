# Render Blueprint for Paint Inventory Management System
# This file allows you to deploy the entire app with one click via Render Blueprint

services:
    # Backend API (Node.js/Express)
    - type: web
      name: paint-inventory-api
      env: node
      region: oregon
      plan: starter # $7/month - change to 'free' for testing (spins down after 15 min)
      buildCommand: npm install
      startCommand: npm start
      rootDir: backend
      envVars:
          - key: NODE_ENV
            value: production
          - key: PORT
            value: 4444
          - key: DB_URL
            fromDatabase:
                name: paint-inventory-db
                property: connectionString
          - key: JWT_SECRET
            generateValue: true # Render auto-generates secure secret
          - key: FRONTEND_URL
            value: https://paint-inventory.onrender.com # Update with your frontend URL
          - key: ADMIN_EMAIL
            value: conner@matsonbrotherspainting.com
          - key: ADMIN_PASSWORD
            sync: false # You'll need to set this manually in Render Dashboard
      healthCheckPath: /health

    # Frontend (Next.js with SSr)
    - type: web
      name: paint-inventory
      env: node
      region: oregon
      plan: starter
      buildCommand: npm install && npm run build
      startCommand: npm start
      rootDir: frontend
      envVars:
          - key: NODE_ENV
            value: production
          - key: PORT
            value: 3333
          - key: NEXT_PUBLIC_API_URL
            value: https://paint-inventory-api.onrender.com/api
